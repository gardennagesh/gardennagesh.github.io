<p>/* Please INDENT in Linux by running indent utility on src_file_name */</p>
<p>/* Developer: Nagesh Nanjundachari */</p>
<p>/* Email: garden.nagesh@gmail.com  */</p>
<p>/* Please  make sure your Linux ENVIORNMENT has UTF-8 enabled */ </p>
<p>/* Compile: gcc -Wall utf8symbol.c  */</p>
<p>/* Usage: ./a.out */</p>
<p>/* Enter strings with ASCII chars AND chars utf-8 chars EURO, POUND, CHESS symbols from stdin*/</p>
<p>/* Enter Q to quit */</p>

<p>#include&ltstdio.h&gt</p>
<p>#include&ltstring.h&gt</p>

<p>/* UTF-8   : BYTE_BITS*/</p>
<p>/* B0_BYTE : 0XXXXXXX */</p>
<p>/* B1_BYTE : 10XXXXXX */</p>
<p>/* B2_BYTE : 110XXXXX */</p>
<p>/* B3_BYTE : 1110XXXX */</p>
<p>/* B4_BYTE : 11110XXX */</p>
<p>/* B5_BYTE : 111110XX */</p>
<p>/* B6_BYTE : 1111110X */</p>

<p>#define B0_BYTE 0x00</p>
<p>#define B1_BYTE 0x80</p>
<p>#define B2_BYTE 0xC0</p>
<p>#define B3_BYTE 0xE0</p>
<p>#define B4_BYTE 0xF0</p>
<p>#define B5_BYTE 0xF8</p>
<p>#define B6_BYTE 0xFC</p>
<p>#define B7_BYTE 0xFE</p>
<p></p>
<p></p>
<p>/* Please tune this as per number of lines input */</p>
<p>#define MAX_UTF8_STR 10</p>

<p>/* 600 is used because 6byteX100chars */</p>
<p>#define MAX_UTF8_CHR 600</p>

<p></p>

<p>void func_find_utf8 (char *ptr_to_str); </p>
<p>void print_non_ascii (int bytes, char *pbyte);</p>

<p>char strbuf[MAX_UTF8_STR][MAX_UTF8_CHR];</p>

<p>int main (int ac, char * av[]) {</p>
<p>int i=0; </p>
<p>char no_newln_str[MAX_UTF8_CHR];</p>


<p>	i = 0;</p>
<p>	printf ("\n\nYou can enter utf-8 string or Q/q to QUIT\n\n");</p>
<p>	while (i < MAX_UTF8_STR) {</p>
<p>		fgets (strbuf[i], MAX_UTF8_CHR, stdin);</p>
<p>		if (!strlen(strbuf[i])) break;</p>
<p>		if ((strbuf[i][0] == 'Q') || (strbuf[i][0] == 'q')) break;</p>
<p>		strcpy (no_newln_str, strbuf[i]);</p>
<p>		no_newln_str[strlen(no_newln_str)-1] = 0;</p>
<p>		func_find_utf8 (no_newln_str);                                                                     </p>
<p>		++i;</p>
<p>	}</p>

<p>	return 1;</p>
<p>}</p>

<p>void func_find_utf8 (char *ptr_to_str) {</p>
<p>int  found_non_ascii;</p>
<p>char *pbyte;</p>

<p>	pbyte = ptr_to_str;</p>

<p>	found_non_ascii = 0;</p>
<p>	while (*pbyte) {</p>
<p>		if ((*pbyte & B1_BYTE) == B0_BYTE) {</p>
<p>			pbyte++;</p>
<p>			continue;</p>
<p>		}</p>
<p>		else {</p>
<p>			found_non_ascii = 1;</p>
<p>			if ((*pbyte & B7_BYTE) == B6_BYTE) {</p>
<p>				print_non_ascii (6, pbyte); </p>
<p>				pbyte+=6; 	</p>
<p>				continue;</p>
<p>			}</p>
<p>			if ((*pbyte & B6_BYTE) == B5_BYTE) {</p>
<p>				print_non_ascii (5, pbyte); </p>
<p>				pbyte+=5; 	</p>
<p>				continue;</p>
<p>			}</p>
<p>			if ((*pbyte & B5_BYTE) == B4_BYTE) {</p>
<p>				print_non_ascii (4, pbyte); </p>
<p>				pbyte+=4; 	</p>
<p>				continue;</p>
<p>			}</p>
<p>			if ((*pbyte & B4_BYTE) == B3_BYTE) {</p>
<p>				print_non_ascii (3, pbyte); </p>
<p>				pbyte+=3; 	</p>
<p>				continue;</p>
<p>			}</p>
<p>			if ((*pbyte & B3_BYTE) == B2_BYTE) {</p>
<p>				print_non_ascii (2, pbyte); </p>
<p>				pbyte+=2; 	</p>
<p>				continue;</p>
<p>			}</p>
<p>		}</p>
<p>	}</p>
<p>		if (found_non_ascii) printf ("   These are Non Ascci chars\n");</p>
<p>}</p>
<p></p>
<p>void print_non_ascii (int bytes, char *pbyte) {</p>
<p>char store[6];</p>
<p>int i;</p>
	
<p>	memset (store, 0, 6);</p>
<p>	memcpy (store, pbyte, bytes);</p>
<p>	i = 0;</p>
<p>	while (i&ltbytes) printf ("%c", store[i++]);</p>
<p>	printf ("%c", ' ');</p>
<p>	fflush (stdout);</p>
<p>}</p>
<p></p>
